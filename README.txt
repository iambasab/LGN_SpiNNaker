#######
ACTION SEQUENCE FOR GENERATING DATA USING THE SCRIPTS IN THIS FOLDER
#########

(A) The main script is: SysManCyberB_Tonic_Design_September16.py
This will hereafter be referred to as the MS.

The data that will be generated by executing the script will be stored in a folder in this directory. The naming convention of the folder is as follows:

Sim<N>_<F>hz_0916,
where N stands for the serial number of the simulation depending on what combination of p1 (trn to tcr connectivity) and p2 (in to tcr connectivity) are set to in the MS (see above for acronym).;
and F stands for what is the frequency of the external (retinal) input.

Thus, depending on what the settings are in the MS, N and F need to be modified within MS prior to each simulation run, each of which will generate 20 sets of data for each population recording the membrane potentials; another 20 sets of data for each population recording the spike patterns.

Furthermore, the connectivity matrices for each of the 20 simulations and beween each of the total of 7 connectivities in the network will be generated as .csv files with a naming convention thus:
thisloop<L>_thisproj<projnum>.csv
where L is the number of loops, which will be all numbers beween and including 1 and 20; 
and projnum refers to the projection number (see the MS where each of the 7 projections in the network are numbered from 0 to 6).
Each of the .csv files stores the projections as a 2-D matrix that can be called directly from within MS Excel or from within Matlab, and thus can be plotted or visualised easily.

(B) All the thisloop<L>_thisproj<projnum>.csv files will be generated in the present directory, and thus would need to be moved to the Sim<N>_<F>hz_0916 directory corresponding to each simulation.
Thus, before proceeding to visualising data, do this on the Terminal:
(from pwd, write the following)
mv this* ./Sim<N>_<F>hz_0916/

This should move all the .csv files out of the present working directory.

(C) The spike patterns as well as the membrane potential for any one simulation can be seen by executing the script
VisualisingThalamicPopNtwrkSpkngBehaviour.py
This will prompt for a user input for number <L> between 1 to 20.
Put any number and press enter; the results of simulation during the <L>th loop run of the MS will be displayed - both spike patterns and membrane potential for each simulation can be observed.

(D) Next, we need to observe the power spectral behaviour and also able to save the figures. For this, we use Matlab. The first step towards this will be to remove the header lines from the generated .dat files and stored in the Sim<N>_<F>hz_0916 folder.
This is done by executing the following script:
removeHeaderlines.py

This file works in two steps:
(1) inputs the data from the Sim<N>_<F>hz_0916 folder.
Thus, for working on the current data, the N and F will need to be updated accordingly.

(2) Storing the 'de-headed' .dat files to another folder:
matlabFiles/SysManCyberB_Sep16

Within this set of folders are created another two sets of folders viz.
(i) exp<F>hz,
where F is same as defined in (A).
(ii) Sim<N>
where N is same as defined in (A)

For this, I say
mkdir ~/matlabFiles/SysManCyberB_Sep16/exp<F>hz

Next, for each <F> hz, we would have 5 sets of simulations running in this particular experiments.
Thus each folder exp<F>hz will consist of 5 sets of folders Sim<N>, where N varies from 1 to 5. This can be done with a single command thus:
mkdir ~/matlabFiles/SysManCyberB_Sep16/exp<F>hz/Sim{1..5}

Once this is done, we now move to the 

(E) Matlab software, all files of which are stored within the folder matlabFiles within the current folder. The main script that we work with from within this current folder (~/matlabFiles/) is:

(F) DataVisualisationSep16.m
Three sets of variables need to be changed from within this script:

(1) Given in Lines 32-34: <population name>=<number of neurons in population>
Each of the lines are set to tally with the data set in MS to build the network. 
Do the following: Uncomment any one of the three lines.

(2) Given in Lines 50-52: The current neuronal population is set to <population name>.
Do the following: Uncomment any of the three lines corresponding to the previous step.

(3) Given in Lines 59-61 :
filename=sprintf('./SysManCyberB_Sep16/exp<F>hz/Sim<N>/<population name>_%d.dat',loop);

Do the following:
Uncomment any one of the three lines corresponding to the previous two steps;
change <F> for each change in experiment settings;
Change <N> for each run

(G) The function fun_stft.m is called from within the script DataVisualisationSep16.m
For changing the settings, open the function script in the editor and proceed accordingly.


###########################################################
LOG OF ACTIVITIES FROM BEGINNING OF PROJECT TO SEPTEMBER 2016
###########################################################

'''
12th - 16th september: 
Trying to record the projections using .getweights - and finally succeeded today with help from Loci - 
Have saved the files with the periodic inputs and revised earlier work. Need to look into comparison with Poisson spike trains now.


9th September: running using spalloc from it 302

19th August: Passing this on to Loci for creaing multiple instances of the main code
modelling the Lateral Geniculate Nucleus (LGN)
LOG: Basab

5th July: running results with possion (aperiodic) spike trains but at same frequencies as with periodic spike trains.
3rd -4th July - running and storing results with regular spike trains at frequencies 23Hz, 19Hz, 15Hz, 11Hz, 8Hz, 4.5Hz, 3.2Hz. The 19Hz frequency
was particularly used at first, to test the several range of parameters, especially varying p1 and p2 (see below for definition) for all 5 combinations
(see at the beginning of the code). Also, a set of Simxa folders contain data when the TRN to TCR feedback connectivity weight was increased to 4.
This was just to test with the set basal value of 2 (as a result of prior experiments on the spiking behaviours). As before, we note that with all other
parameter values as they are, increasing TRN to TCR feedback from 2 to 4 resulted in erratic response from TCR, which intuitively (needs lots of more simulations
to make a statement, and also with a large number of neurons) feels like due to the increased suppression of spiking neurons in the TCR population,
considering the connectivity is also sparse.
30th June - After some initial hiccups, finally could assimilate the data for p1 and p2, and store in Sim 1. But only one instance out of 5 was
'successful' in the sense that the means of the neurons responded till the end.
Now, the values of
29th JUne - running the population network: with both p1 and p2 (probability of connection of TRN And IN respectively, to TCR, to 0.15
11th June: Testing with Single neurons in the circuit.
6th June -  Retested the tonic mode. The offset current values, when there are no synaptic weights, produce fast spking and regular spiking effects with the defined values of abcd parameters.
However, this offset current cannot be negated.
On the other hand, with offset 0, the synaptic weights, there is a conductance based current weighted with the synapses (refer to Andrew's mail) that causes spiking
in the cells, but the effects of fast spiking and regular spiking are not apparent. Unless of course tested with high frequency input spike train. The FS firing can
reproduce a higher frequency at the output that can the RS cells.
1st June 2016: Pape and McCormick 95 - need to determine the ISI.

31st January 2016: The Bursting experiment upto the single mini-column is done - so starting the tonic testing now.
So the first thing to do is change the range of i to (2,3)

24TH JANUARY 2016: FINALISED THE VISUALISATION AT THE END OF THE FILE FOR GENERATING AND SAVING FIGURES 1, 2 AND 3 IN THE PAPER DRAFT
FOR SUBMISSION TO IEEE TRANSACTIONS IN BIOMEDICAL CIRCUITS AND SYSTEMS
THE THREE CONDITIONS ARE:
(1) TONIC BURSTING FOR ALL CELLS WHEN SPIKE SOURCE IS EXCITATORY FOR ALL CELLS, AND WITH MINIMAL ISI TO ELICIT ONE-TO-ONE RESPONSE IN THE CELLS.
THE CONNECTION WEIGHTS ARE SET AS 1.
(2) SAME SPIKE SOURCE INTERVAL, BUT NOW THE PROJECTED SPIKE TO ALL CELLS IS INHIBITORY. THE CONNECTION WEIGHTS ARE INCREASED TO 10.
(3) THE SPIKE SOURCE PROJECTION IS STILL INHIBITORY, CONNECTION WEIGHT IS INCREASED TO 15;
AND THE INTERSPIKE INTERVAL TO ELICIT ONE-TO-ONE FOR GENERATING POST-INHIBITORY-BURST-RESPONSE

LOG JANUARY 2016: SETTING SINGLE NEURON BEHAVIOUR OF TCR, TRN, IN PRIOR TO BUILDING POPULATIONS
LOG 28TH DECEMBER 2015: BEING TESTED WITH THALAMIC FIRING MODES PAPER RESULTS AND OBSERVATIONS: BASAB

LOG: 7TH AUGUST 2015
THE PARAMETETCR OF THE EARLIER MODEL IS CHANGED ACCORDING TO THE ONES WHEN WORKING WITH RAHMI -  MAINLY THE I-OFFSET IS CHANGED TO 0, BECAUSE WHEN THE NEURONS ARE USED
WITHIN A NETWORK, THEIR INPUT CURRENTS WILL BE PROVIDED BY OTHER NEURONS WITHIN THE NETWORK AND HENCE THEY WOULD NOT NEED AN EXPLICIT DRIVER CURRENT.
ALSO, THE U VARIABLES ARE MADE NON-ZERO, WHICH MAKES A DIFFERENCE TO THE INITIAL CONDITION OF THE PLOT BUT AN INSIGNIFICANT CHANGE.
FURTHER, THE TAU PARAMETERS ARE INCREASED, WHICH DOES NOT MAKE ANY VISIBLE DIFFERENCE IN THE CASE OF INHIBITORY SPIKE SOURCE,
BUT IN THE CASE OF AN EXCITATORY SPIKE SOURCE, THE RATE OF SPIKING IN ALL OF THE NEURONS INCREASES.
'''
